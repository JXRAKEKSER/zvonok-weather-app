import{u as f}from"./city.store-B5G6NiG7.js";import{F as b,a as F,_ as L}from"./forecast.service-CWKppyGn.js";import{g as m,q as g,p as N,s as $,x as k,d as h,y as E,a as S,e as R,w as P,f as c,k as p,t as l,u as n,o as i,_ as y,c as _,z as x,F as C,l as w}from"./index-fRIpYGtX.js";import{u as V}from"./useConditionLabel-MWR75QXD.js";const q=new b(new F);function B(){const s=f(),t=m(null),o=m(!1),e=m(null),{show:r,TOAST_TYPES:a}=$();async function v(d){try{o.value=!0;const u=await q.getShortDailyForecast(d.coordinates);if(!t.value)return t.value=[{...u,cityName:d.name,dayPart:""}];t.value.push({...u,cityName:d.name,dayPart:""})}catch(u){r({message:"Ошибка загрузки данных",type:a.ERROR}),u instanceof Error&&(e.value=u),console.error("error")}finally{o.value=!1}}return g(()=>{s.popularCities&&s.popularCities.forEach(v)}),N(async()=>{try{await s.actions.getPopularCities()}catch{r({message:"Ошибка загрузки популярных городов",type:a.ERROR})}}),{forecasts:t,isLoadingForecasts:o,forecastsLoadingError:e,actions:{getForecast:v}}}function I(){const s=k(),t=f();g(()=>{var e;if(!s.query.city)return;const o=(e=t.cities)==null?void 0:e.find(r=>r.name===s.query.city);o&&t.setters.setCurrentCity(o)})}const O={class:"popular-city-card__name"},T={class:"popular-city-card__condition-label popular-city-card__condition-label_first-letter_capitalized"},W={class:"popular-city-card__temperature"},z={class:"popular-city-card__humidity"},D=h({__name:"PopularCityCard",props:{cityName:{},condition:{},temperature:{},humidity:{}},setup(s){const t=s,{conditionLabel:o}=V(E(()=>t.condition));return(e,r)=>{const a=R("RouterLink");return i(),S(a,{class:"popular-city-card",to:{name:e.$route.name,query:{city:e.cityName}}},{default:P(()=>[c("h5",O,l(e.cityName),1),c("span",T,l(n(o)),1),p(n(L),{condition:e.condition},null,8,["condition"]),c("span",W,l(e.temperature)+"°",1),c("span",z,l(e.humidity)+"%",1)]),_:1},8,["to"])}}}),A=y(D,[["__scopeId","data-v-2787b7fe"]]),M={},Q={class:"sceleton-card"};function Y(s,t){return i(),_("article",Q,t[0]||(t[0]=[x('<h5 class="sceleton-card__text" data-v-b44758ca></h5><span class="sceleton-card__text" data-v-b44758ca></span><div class="sceleton-card__image" data-v-b44758ca></div><span class="sceleton-card__text" data-v-b44758ca></span><span class="sceleton-card__text" data-v-b44758ca></span>',5)]))}const j=y(M,[["render",Y],["__scopeId","data-v-b44758ca"]]),G={class:"popular-cities"},H={class:"popular-cities__list"},J=h({__name:"PopularCities",setup(s){const{forecasts:t,isLoadingForecasts:o}=B();return I(),(e,r)=>(i(),_("section",G,[r[0]||(r[0]=c("h4",{class:"popular-cities__title"},"Погода в популярных городах",-1)),c("ul",H,[n(o)?(i(),_(C,{key:0},w(3,a=>p(j,{class:"popular-cities__popular-city-card"})),64)):(i(!0),_(C,{key:1},w(n(t),a=>(i(),S(A,{class:"popular-cities__popular-city-card",key:a.city.toString(),"city-name":a.cityName,temperature:a.temperature,condition:a.condition,"wind-speed":a.windSpeed,humidity:a.humidity},null,8,["city-name","temperature","condition","wind-speed","humidity"]))),128))])]))}}),K=y(J,[["__scopeId","data-v-97190f12"]]),U={class:"weather-layout"},X={class:"weather-layout__title"},Z=h({__name:"WeatherLayout",setup(s){const t=f();return(o,e)=>{var a;const r=R("RouterView");return i(),_("div",U,[c("h1",X," Погода в городе "+l(((a=n(t).currentCity)==null?void 0:a.name)??""),1),e[0]||(e[0]=c("h3",{class:"weather-layout__date"},"суббота, 22 марта",-1)),p(r),p(n(K),{class:"weather-layout__popular-cities"})])}}}),ot=y(Z,[["__scopeId","data-v-609eede6"]]);export{ot as default};
